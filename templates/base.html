{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>{% block title %}업무시스템{% endblock %}</title>

  <!-- ✅ 공통 CSS 라이브러리 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">

  <!-- ✅ 공통 스타일 -->
  <link rel="stylesheet" href="{% static 'css/base.css' %}">
</head>

<body style="padding-top: 50px;">
{% if user.is_authenticated %}
<!-- ✅ 네비게이션 바 -->
<nav class="navbar navbar-expand-lg fixed-top shadow-sm bg-white">
  <div class="container-fluid">
    <a class="navbar-brand" href="{% url 'home' %}">
      <img src="{% static 'images/logo.png' %}" alt="인카 로고" style="height: 40px;">
    </a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse justify-content-center" id="navbarContent">
      <ul class="navbar-nav mb-2 mb-lg-0">
        
        <!-- ✅ 대시보드 -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle {% if '/dash' in request.path %}active{% else %}inactive{% endif %}"
             href="#" id="dashMenu" data-bs-toggle="dropdown">대시보드</a>
          <ul class="dropdown-menu" aria-labelledby="dashMenu">
            <li><a class="dropdown-item" href="{% url 'dash_sales' %}">매출현황</a></li>
            <li><a class="dropdown-item" href="{% url 'dash_recruit' %}">리쿠르팅</a></li>
            <li><a class="dropdown-item" href="{% url 'dash_retention' %}">유지율</a></li>
          </ul>
        </li>

        <!-- ✅ 업무요청 -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle {% if '/board' in request.path %}active{% else %}inactive{% endif %}"
             href="#" id="boardMenu" data-bs-toggle="dropdown">업무요청</a>
          <ul class="dropdown-menu" aria-labelledby="boardMenu">
            <li><a class="dropdown-item" href="{% url 'post_list' %}">요청게시판</a></li>
            <li><a class="dropdown-item" href="{% url 'support_form' %}">업무요청서</a></li>
          </ul>
        </li>

        <!-- ✅ 관리자 전용 메뉴 -->
        {% if user.grade == 'superuser' %}
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle {% if '/commission' in request.path %}active{% else %}inactive{% endif %}"
             href="#" id="commissionMenu" data-bs-toggle="dropdown">수수료</a>
          <ul class="dropdown-menu" aria-labelledby="commissionMenu">
            <li><a class="dropdown-item" href="{% url 'deposit_home' %}">채권관리</a></li>
            <li><a class="dropdown-item" href="{% url 'support_home' %}">지원신청서</a></li>
            <li><a class="dropdown-item" href="{% url 'approval_home' %}">수수료결재</a></li>
          </ul>
        </li>
        {% endif %}

        <!-- ✅ 기타 -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle {% if '/join' in request.path %}active{% else %}inactive{% endif %}"
             href="#" id="joinMenu" data-bs-toggle="dropdown">매뉴얼</a>
          <ul class="dropdown-menu" aria-labelledby="joinMenu">
            <li><a class="dropdown-item" href="{% url 'join:support_manual' %}">업무매뉴얼</a></li>
            <li><a class="dropdown-item" href="{% url 'join:support_rules' %}">영업기준안</a></li>
          </ul>
        </li>

        {% if user.grade == 'superuser' %}
        <li class="nav-item">
          <a class="nav-link {% if '/admin' in request.path %}active{% else %}inactive{% endif %}"
             href="{% url 'home' %}admin/">관리자</a>
        </li>
        {% endif %}
      </ul>
    </div>

    <!-- ✅ 로그아웃 -->
    <form method="post" action="{% url 'logout' %}" class="d-none d-lg-flex">
      {% csrf_token %}
      <button type="submit" class="btn btn-logout">로그아웃</button>
    </form>
  </div>
</nav>
{% endif %}

<!-- ✅ 페이지 본문 -->
<div class="container my-5">
  {% block content %}{% endblock %}
</div>

<!-- ✅ 공통 JS 라이브러리 -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<!-- ✅ 공통 UI 동작 (별도 파일) -->
<script src="{% static 'js/base_ui.js' %}"></script>

<!-- ✅ 페이지별 추가 스크립트 로딩 영역 -->
{% block extra_js %}{% endblock %}

</body>
</html>
