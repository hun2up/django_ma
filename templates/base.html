<!-- django_ma/templates/base.html-->
{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>{% block title %}ì—…ë¬´ì‹œìŠ¤í…œ{% endblock %}</title>

  <!-- âœ… ê³µí†µ CSS ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">

  <!-- âœ… ê³µí†µ ìŠ¤íƒ€ì¼ -->
  <link rel="stylesheet" href="{% static 'css/base.css' %}">
</head>

<body style="padding-top: 50px;">

<!-- âœ… ë¡œê·¸ì¸í•œ ê²½ìš°ì—ë§Œ ë„¤ë¹„ê²Œì´ì…˜ ì¶œë ¥ -->
{% if user.is_authenticated %}
<!-- âœ… ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
<nav class="navbar navbar-expand-lg fixed-top shadow-sm bg-white">
  <div class="container-fluid position-relative">
    <!-- ğŸ”¹ ë¡œê³  (ì¢Œì¸¡ ê³ ì •) -->
    <a class="navbar-brand" href="{% url 'home' %}">
      <img src="{% static 'images/logo.png' %}" alt="ì¸ì¹´ ë¡œê³ " style="height: 40px;">
    </a>

    <!-- ğŸ”¹ ëª¨ë°”ì¼ í† ê¸€ -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- ğŸ”¹ ì¤‘ì•™ ë©”ë‰´ -->
    <div class="collapse navbar-collapse justify-content-center position-absolute start-50 translate-middle-x" id="navbarContent" style="width: fit-content;">
      <ul class="navbar-nav mb-2 mb-lg-0"> 

        {% if user.grade == 'superuser' or user.grade == 'main_admin' or user.grade == 'sub_admin' %}
          <!-- âœ… ëŒ€ì‹œë³´ë“œ -->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle {% if '/dash' in request.path %}active{% else %}inactive{% endif %}" href="#" id="dashMenu" data-bs-toggle="dropdown">ëŒ€ì‹œë³´ë“œ</a>
            <ul class="dropdown-menu" aria-labelledby="dashMenu">
              <li><a class="dropdown-item" href="{% url 'dash_sales' %}">ë§¤ì¶œí˜„í™©</a></li>
              <li><a class="dropdown-item" href="{% url 'dash_recruit' %}">ë¦¬ì¿ ë¥´íŒ…</a></li>
              <li><a class="dropdown-item" href="{% url 'dash_retention' %}">ìœ ì§€ìœ¨</a></li>
            </ul>
          </li>
        {% endif %}

        <!-- âœ… ì—…ë¬´ìš”ì²­ -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle {% if '/board' in request.path %}active{% else %}inactive{% endif %}" href="#" id="boardMenu" data-bs-toggle="dropdown">ì—…ë¬´ìš”ì²­</a>
          <ul class="dropdown-menu" aria-labelledby="boardMenu">
            <li><a class="dropdown-item" href="{% url 'post_list' %}">ìš”ì²­ê²Œì‹œíŒ</a></li>
            {% if user.grade != 'inactive' %}
              <li><a class="dropdown-item" href="{% url 'support_form' %}">ì—…ë¬´ìš”ì²­ì„œ</a></li>
            {% endif %}
            {% if user.grade != 'inactive' %}
              <li><a class="dropdown-item" href="{% url 'states_form' %}">FAì†Œëª…ì„œ</a></li>
            {% endif %}
          </ul>
        </li>

        {% if user.grade == 'superuser' or user.grade == 'main_admin' or user.grade == 'sub_admin' %}
          <!-- âœ… ì¡°ì§ê´€ë¦¬ -->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle {% if '/partner' in request.path %}active{% else %}inactive{% endif %}" href="#" id="boardMenu" data-bs-toggle="dropdown">ì¡°ì§ê´€ë¦¬</a>
            <ul class="dropdown-menu" aria-labelledby="boardMenu">              
              <li><a class="dropdown-item" href="{% url 'partner:manage_charts' %}">í¸ì œë³€ê²½</a></li>
              <li><a class="dropdown-item" href="{% url 'partner:manage_rate' %}">ìš”ìœ¨ë³€ê²½</a></li>
              <li><a class="dropdown-item" href="{% url 'partner:manage_calculate' %}">ì§€ì íš¨ìœ¨</a></li>
              {% if user.grade == 'superuser' or user.grade == 'main_admin' %}
                <li><a class="dropdown-item" href="{% url 'partner:manage_grades' %}">ê¶Œí•œê´€ë¦¬</a></li>
              {% endif %}
            </ul>
          </li>
        {% endif %}

        {% if user.grade == 'superuser' %}
          <!-- âœ… ê´€ë¦¬ì ë©”ë‰´ -->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle {% if '/commission' in request.path %}active{% else %}inactive{% endif %}" href="#" id="commissionMenu" data-bs-toggle="dropdown">ìˆ˜ìˆ˜ë£Œ</a>
            <ul class="dropdown-menu" aria-labelledby="commissionMenu">
              <li><a class="dropdown-item" href="{% url 'deposit_home' %}">ì±„ê¶Œê´€ë¦¬</a></li>
              <li><a class="dropdown-item" href="{% url 'support_home' %}">ì§€ì›ì‹ ì²­ì„œ</a></li>
              <li><a class="dropdown-item" href="{% url 'approval_home' %}">ìˆ˜ìˆ˜ë£Œê²°ì¬</a></li>
            </ul>
          </li>
        {% endif %}

        {% if user.grade != 'inactive' %}
          <!-- âœ… ë§¤ë‰´ì–¼ -->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle {% if '/join' in request.path %}active{% else %}inactive{% endif %}" href="#" id="joinMenu" data-bs-toggle="dropdown">ë§¤ë‰´ì–¼</a>
            <ul class="dropdown-menu" aria-labelledby="joinMenu">
              <li><a class="dropdown-item" href="{% url 'join:manual_basic' %}">ì—…ë¬´ë§¤ë‰´ì–¼</a></li>
              {% if user.grade == 'superuser' or user.grade == 'main_admin' %}
                <li><a class="dropdown-item" href="{% url 'join:manual_head' %}">ì—…ë¬´ë§¤ë‰´ì–¼(ê´€ë¦¬ì)</a></li>
              {% endif %}
              <li><a class="dropdown-item" href="{% url 'join:rules_basic' %}">ì˜ì—…ê¸°ì¤€ì•ˆ</a></li>
              {% if user.grade == 'superuser' or user.grade == 'main_admin' %}
                <li><a class="dropdown-item" href="{% url 'join:rules_head' %}">ì˜ì—…ê¸°ì¤€ì•ˆ(ê´€ë¦¬ì)</a></li>
              {% endif %}
            </ul>
          </li>
        {% endif %}

        {% if user.grade == 'superuser' %}
          <li class="nav-item">
            <a class="nav-link {% if '/admin' in request.path %}active{% else %}inactive{% endif %}" href="{% url 'home' %}admin/">ê´€ë¦¬ì</a>
          </li>
        {% endif %}
      </ul>
    </div>

    <!-- ğŸ”¹ ìš°ì¸¡ ì‚¬ìš©ì ì •ë³´ + ë¡œê·¸ì•„ì›ƒ -->
    <div class="d-none d-lg-flex align-items-center ms-auto">
      <div class="me-3" style="font-weight:500; color:#333;">
        {{ user.branch }}&nbsp;<strong>{{ user.name }}({{ user.id }})</strong>
      </div>
      <form method="post" action="{% url 'logout' %}">
        {% csrf_token %}
        <button type="submit" class="btn btn-logout">ë¡œê·¸ì•„ì›ƒ</button>
      </form>
    </div>
  </div>
</nav>
{% endif %}

<!-- âœ… í˜ì´ì§€ ë³¸ë¬¸ -->
<div class="container my-5">
  {% block content %}{% endblock %}
</div>

<!-- âœ… ê³µí†µ JS ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<!-- âœ… ê³µí†µ UI ë™ì‘ (ë³„ë„ íŒŒì¼) -->
<script src="{% static 'js/base_ui.js' %}"></script>

<!-- âœ… DataTables + Export Buttons CDN -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.8/css/dataTables.bootstrap5.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.bootstrap5.min.css">
<link rel="stylesheet" href="{% static 'css/datatable_custom.css' %}">

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.8/js/dataTables.bootstrap5.min.js"></script>

<!-- âœ… Export Buttons -->
<script src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.bootstrap5.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.print.min.js"></script>

<!-- âœ… ê³µìš© ì´ˆê¸°í™” JS -->
<script src="{% static 'js/datatable_config.js' %}"></script>

<script src="{% static 'js/excel_upload.js' %}"></script>

<!-- âœ… í˜ì´ì§€ë³„ ì¶”ê°€ ìŠ¤í¬ë¦½íŠ¸ ë¡œë”© ì˜ì—­ -->
{% block extra_js %}{% endblock %}

</body>
</html>
