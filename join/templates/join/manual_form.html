{# django_ma/join/templates/join/manual_form.html #}
{% extends "base.html" %}
{% block title %}업무매뉴얼{% endblock %}

{% block content %}
<div class="container" style="max-width: 1000px;">

  {# ===== Title ===== #}
  <div class="d-flex align-items-start justify-content-between gap-3 mb-3">
    <div>
      <h2 class="fw-bold mb-1" style="color:#003f7d;">
        {% if mode == "edit" %}매뉴얼 수정{% else %}매뉴얼 작성{% endif %}
      </h2>
      <div class="text-muted small">
        표/이미지/링크 삽입이 가능하며 저장 시 HTML로 보관됩니다.
      </div>
    </div>

    <div class="d-flex gap-2">
      {% if mode == "edit" %}
        <a class="btn btn-outline-secondary"
           href="{% url 'join:manual_detail' manual.pk %}">
          돌아가기
        </a>
      {% else %}
        <a class="btn btn-outline-secondary"
           href="{% url 'join:manual_list' %}">
          목록
        </a>
      {% endif %}
    </div>
  </div>

  {# ===== Form ===== #}
  <form method="post" enctype="multipart/form-data" class="card p-4">
    {% csrf_token %}
    {{ form.media }} {# CKEditor 관련 JS/CSS #}

    <div class="mb-3">
      <label class="form-label fw-semibold mb-1" for="{{ form.title.id_for_label }}">제목</label>
      {{ form.title }}
      {% if form.title.errors %}
        <div class="text-danger small mt-1">{{ form.title.errors }}</div>
      {% endif %}
    </div>

    <div class="mb-3">
      <label class="form-label fw-semibold mb-1" for="{{ form.content.id_for_label }}">내용</label>
      {{ form.content }}
      {% if form.content.errors %}
        <div class="text-danger small mt-1">{{ form.content.errors }}</div>
      {% endif %}
    </div>

    <div class="form-check mb-3">
      {{ form.is_published }}
      <label class="form-check-label" for="{{ form.is_published.id_for_label }}">공개</label>
    </div>

    <div class="d-flex gap-2 justify-content-end">
      {% if mode == "edit" %}
        <a class="btn btn-secondary"
           href="{% url 'join:manual_detail' manual.pk %}">
          취소
        </a>
      {% else %}
        <a class="btn btn-secondary"
           href="{% url 'join:manual_list' %}">
          취소
        </a>
      {% endif %}
      <button class="btn btn-primary" type="submit">
        저장
      </button>
    </div>
  </form>
</div>

<script>
  // 템플릿 수준에서 부트스트랩 클래스 보정 (폼 위젯에 class를 넣는 게 정석이지만, 현상 유지 목적)
  document.addEventListener("DOMContentLoaded", () => {
    const title = document.querySelector('input[name="title"]');
    if (title) title.classList.add("form-control");
  });
</script>
{% endblock %}
