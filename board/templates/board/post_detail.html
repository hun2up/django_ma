<!--django_ma/board/templates/board/post_detail.html-->
{% extends "base.html" %}
{% load static %}

{% block title %}ì—…ë¬´ìš”ì²­ ìƒì„¸ë³´ê¸°{% endblock %}

{% block content %}
<div class="container mt-5">

  {% if messages %}
    <div class="container mt-3">
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show text-center" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    </div>
  {% endif %}
  
  <div class="mx-auto" style="max-width: 700px;">

    <!-- ğŸ”¹ ì¹´ë“œ ì‹œì‘ -->
    <div class="card shadow p-4 border-0 rounded-4">

      <!-- ğŸ”¸ ì œëª© + ì‘ì„±ì¼ì -->
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h5 class="fw-bold mb-0" style="color:#003f7d;">{{ post.title }}</h5>
        <p class="text-muted small mb-0">{{ post.created_at|date:"Y-m-d H:i" }}</p>
      </div>

      <!-- ğŸ”¸ êµ¬ë¶„ì„  -->
      <hr class="mb-4 mt-2">

      <!-- ğŸ”¸ í•„ë“œ ìš”ì•½ ì •ë³´ (1ì¤„ 3ê°œ ë°°ì¹˜) -->
      <div class="mb-3">
        <div class="row">
          <!-- êµ¬ë¶„ -->
          <div class="col-md-4 mb-2">
            <strong class="text-muted">êµ¬ë¶„:</strong>
            {% if post.category and post.category != "ì„ íƒ" %}
              {{ post.category }}
            {% else %}
              -
            {% endif %}
          </div>

          <!-- ëŒ€ìƒì ì„±ëª… -->
          <div class="col-md-4 mb-2">
            <strong class="text-muted">ì„±ëª…(ëŒ€ìƒì):</strong>
            {{ post.fa|default:"-" }}
          </div>

          <!-- ëŒ€ìƒì ì‚¬ë²ˆ -->
          <div class="col-md-4 mb-2">
            <strong class="text-muted">ì‚¬ë²ˆ(ëŒ€ìƒì):</strong>
            {{ post.code|default:"-" }}
          </div>

          <!-- ìš”ì²­ì ì†Œì† -->
          <div class="col-md-4 mb-2">
            <strong class="text-muted">ì†Œì†(ìš”ì²­ì):</strong>
            {{ post.user_branch }}
          </div>
          
          <!-- ìš”ì²­ì ì„±ëª… -->
          <div class="col-md-4 mb-2">
            <strong class="text-muted">ì„±ëª…(ìš”ì²­ì):</strong>
            {{ post.user_name }}
          </div>

          <!-- ìš”ì²­ì ì‚¬ë²ˆ -->
          <div class="col-md-4 mb-2">
            <strong class="text-muted">ìš”ì²­ì(ì‚¬ë²ˆ):</strong>
            {{ post.user_id }}
          </div>

        </div>
      </div>

      <!-- ğŸ”¸ ìš”ì²­ ë‚´ìš© -->
      <hr class="my-3">
      <div class="mb-3">
        <strong class="text-muted">ìš”ì²­ ë‚´ìš©:</strong>
        <p class="fs-6 mt-2" style="white-space: pre-wrap;">{{ post.content }}</p>
      </div>

      <!-- ğŸ”¸ ë‹´ë‹¹ì, ìƒíƒœ, ìƒíƒœë³€ê²½ì¼ -->
      <hr class="my-3">
      <div class="mb-3">
        <div class="row align-items-center">
          <!-- ë‹´ë‹¹ì -->
          <div class="col-md-4 mb-2">
            <strong class="text-muted">ë‹´ë‹¹ì:</strong>
            {% if is_superuser %}
              <form method="post" style="display:inline;">
                {% csrf_token %}
                <input type="hidden" name="action_type" value="handler">
                <select name="handler" class="form-select form-select-sm d-inline-block" style="width:auto;">
                  <option value="ì„ íƒ" {% if not post.handler %}selected{% endif %}>ì„ íƒ</option>
                  {% for h in handlers %}
                    <option value="{{ h }}" {% if post.handler == h %}selected{% endif %}>{{ h }}</option>
                  {% endfor %}
                </select>
                <button type="submit" class="btn btn-sm btn-primary">ë³€ê²½</button>
              </form>
            {% else %}
              {{ post.handler|default:"-" }}
            {% endif %}
          </div>

          <!-- ìƒíƒœ -->
          <div class="col-md-4 mb-2">
            <strong class="text-muted">ìƒíƒœ:</strong>
            {% if is_superuser %}
              <form method="post" style="display:inline;">
                {% csrf_token %}
                <input type="hidden" name="action_type" value="status">
                <select name="status" class="form-select form-select-sm d-inline-block" style="width:auto;">
                  {% for s in status_choices %}
                    <option value="{{ s }}" {% if post.status == s %}selected{% endif %}>{{ s }}</option>
                  {% endfor %}
                </select>
                <button type="submit" class="btn btn-sm btn-primary">ë³€ê²½</button>
              </form>
            {% else %}
              <span
                style="
                  {% if post.status == 'í™•ì¸ì¤‘' %}color:orange;
                  {% elif post.status == 'ì§„í–‰ì¤‘' %}color:green;
                  {% elif post.status == 'ë³´ì™„ìš”ì²­' %}color:red;
                  {% elif post.status == 'ì™„ë£Œ' %}color:black;
                  {% elif post.status == 'ë°˜ë ¤' %}color:gray;
                  {% endif %}
                  font-weight:600;
                ">
                {{ post.status }}
              </span>
            {% endif %}
          </div>

          <!-- ìƒíƒœë³€ê²½ì¼ -->
          <div class="col-md-4 mb-2">
            <strong class="text-muted">ìƒíƒœë³€ê²½ì¼:</strong>
            {{ post.status_updated_at|date:"Y-m-d H:i" }}
          </div>
        </div>
      </div>


      <!-- ğŸ”¸ ë²„íŠ¼ ì˜ì—­ -->
      <div class="d-flex justify-content-between mt-4">
        <a href="{% url 'post_list' %}" class="btn btn-outline-secondary">â† ëª©ë¡ìœ¼ë¡œ</a>
        <a href="{% url 'home' %}" class="btn btn-dark">ë©”ì¸ìœ¼ë¡œ</a>
      </div>

    </div>
    <!-- ğŸ”¹ ì¹´ë“œ ë -->

  </div>
</div>
{% endblock %}
