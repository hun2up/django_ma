{% extends 'base.html' %}

{% block title %}업무요청 게시판{% endblock %}

{% block content %}
<h2 class="text-center mb-4" style="color:#003f7d; font-weight:700;">업무요청 게시판</h2>

<div class="card p-4">
  <div class="d-flex justify-content-between mb-3">
    <a href="{% url 'post_create' %}" class="btn btn-primary">[+] 새 글 작성</a>
  </div>

  <div class="table-responsive">
    <table class="table table-hover align-middle">
      <thead class="table-light">
        <tr class="text-center">
          <th>접수번호</th>
          <th>접수일자</th>
          <th>구분</th>
          <th>제목</th>
          <th>요청자</th>
          <th>담당자</th>
          <th>상태</th>
          <th>상태변경일</th>
        </tr>
      </thead>
      <tbody>
        {% for post in posts %}
        <tr>
          <td class="text-center">{{ post.id }}</td>
          <td class="text-center">{{ post.created_at|date:"Y-m-d" }}</td>

          <!-- ✅ 구분 (category) 출력 -->
          <td class="text-center">
            {% if post.category and post.category != "선택" %}
              {{ post.category }}
            {% else %}
              -
            {% endif %}
          </td>

          <!-- ✅ 제목 -->
          <td>
            <a href="{% url 'post_detail' post.pk %}" class="text-decoration-none text-primary">
              {{ post.title }}
            </a>
          </td>

          <td class="text-center">-</td>
          <td class="text-center">-</td>
          <td class="text-center">-</td>
          <td class="text-center">-</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="8" class="text-center text-muted py-4">게시글이 없습니다.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- 페이지네이션 -->
  <div class="text-center mt-3">
    {% if posts.has_previous %}
      <a href="?page={{ posts.previous_page_number }}" class="btn btn-outline-primary btn-sm">이전</a>
    {% endif %}
    <span class="mx-2">Page {{ posts.number }} / {{ posts.paginator.num_pages }}</span>
    {% if posts.has_next %}
      <a href="?page={{ posts.next_page_number }}" class="btn btn-outline-primary btn-sm">다음</a>
    {% endif %}
  </div>
</div>
{% endblock %}
